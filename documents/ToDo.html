<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>OpenLCB To Do: Remaining Questions</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.3  (Unix)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGED" CONTENT="20120515;11571100">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>OpenLCB™ To Do: Remaining Questions</H1>
<P>This page is a place to record OpenLCB™ issues that are still to
be resolved. This is <U>not</U> a place for recording the discussion
or decisions; once a decision is made, it should be implemented in
the documents it affects. In particular, please don't make this a
list of <U>answered</U> questions, those live in the docs we're
writing. The numbering is historical-order; please delete an item
that's done, not renumber below it, so SVN can track progress. If you
want to tag something as high-priority, please use color. Currently,
“<SPAN STYLE="background: #99ccff">blue 8</SPAN>” is
high-priority documentation tasks, and “<SPAN STYLE="background: #00ff00">light
green</SPAN>” is high-priority implementation tasks. (Feel free to
modify those color chooses, they were picked by a color-challenged
person)</P>
<P>12. First definition and implementation of “<SPAN STYLE="font-style: normal">train
control”, e.g. throttles, etc;</SPAN> define initial protocol. See
<A HREF="notes/LocomotiveControl.html">separate document.</A> <SPAN STYLE="font-style: normal">DCC,
of course, but also allowing for other/future systems. Note that this
is separate from e.g. connections to LocoNet, XpressNet, etc. On MERG
hardware?</SPAN></P>
<P>17. Still need to think more about &quot;interface Event&quot;
conventions for e.g. large modular layouts. Via XML naming? Via
EventID conventions? Goal is to link next-neighbor modules easily.
Node and Event spaces for modular clubs? [task done] Let them
allocate it using ownership mechanism. Write some examples. <SPAN STYLE="font-style: normal">See
examples/ModularClubs.html note.</SPAN></P>
<P>18. We plan to define a (small number) of “globally known”
events that people can use if they want to. E.g. “power down” or
“emergency stop”, “RFID detector present”, “display
present” (See lighting item 24 below) (item done)(item done) (item
done) How to get those in e.g. Blue/Gold configuration? See item 45.</P>
<P>20. Write an XML-based representation, e.g. as a separate wire
protocol for web services.</P>
<P>22. Signaling (Signalling) – see <A HREF="notes/Signaling.html">initial
Signaling design note</A>, which is currently just a placeholder.</P>
<P>23. Layout Sound Control 
</P>
<OL START=13>
	<P>Alex: (maybe just an adaptation to P/C Events but maybe should be
	identified at least) DPH: I think this is quite straight-forward. It
	includes complex nodes that can send and receive streams, or store
	the sounds, whether in real-time or not. The control of these should
	be straight-forward with events. Things like volume could use Events
	with data to set absolute levels, or increment and decrement Events.
	<I>(Need example doc for this application! - BobJ)</I></P>
</OL>
<P>24. Layout and Room Lighting Control DPH: Bob can probably fill us
in on this one ;-) as he has some experience with X10 and JMRI. Do we
need to do more than suggest some approaches? Maybe an application
note, showing how it could be done? <I>(Define some recommended
events for room intensity, e.g. how to code intensity in event space;
want a mechanism for events to drive specific pre-selected intensity;
study Insteon solution - BobJ)</I></P>
<P>47. Eventually, write some words about a recommended common log
format (mechanism is being developed in Logging note, but not format
of log records)</P>
<P>54. Need a CAN boot-loader/IPL process definition. May serve as a
good streaming, datagram example, but it's also possible that full
OpenLCB implementation is too much to include in a bootloader
program. “Dumbest possible node” to receive a bootload? Have a
“bootload me” standard event? “00-00” as special case.
Bootload as CAN-specific, very simple protocol? Delay is a problem,
probably has to be driven from program source, if programming more
than one device at a time. Microchip has one, see AN247; could use
that? There's an Amtel bootloader for their processors with built-in
CAN, check that protocol. Build it into same boot-loader as Arduino?</P>
<P><SPAN STYLE="font-style: normal">59. [Task Done] Complete the
“<A HREF="notes/DisplayProtocol.html">Display Protocol</A>” note
and a sample implementation for a display, e.g. of RF or throttle
info.</SPAN></P>
<P STYLE="font-style: normal"><SPAN STYLE="background: #00ff00">61.
Clean up the CBUS-hardware PIC demo. Will this require reimplementing
the C/C++ prototype in C? Very little is actually class based,
struct+function might be just fine anyway.</SPAN></P>
<P>71. The examples/CrossingGateExample.html file is a funny hybrid
of general use case, and OpenLCB-specific documentation. It should
probably have the general use case aspects moved to UseCases.html,
with the specifics left in the examples/CrossingGateExample.html
file.</P>
<P>72. David Harris expressed an interest in an early email in some
standard x,y,z mapping for nodes, detectors, etc. Global and/or local
(module specific) reference frame? Make it easy to find a node in
space from it's NodeID? Is this more than just one aspect of a
general system for storing node-specific info? Is it just the
position of the node (hardware) or also items “within” the node,
e.g. the things it's connected to? Start a note....</P>
<P><SPAN STYLE="background: #99ccff">75. Blue/Gold and “Event
Configuration” have been split into two documents
(examples/BlueGoldConfig.html, EventConfigurationProtocol.html).
These need to be rationalized; at least one probably needs to be a
note or even in main document area.</SPAN></P>
<P>77. Finish notes/RouteCases.html doc and link</P>
<P><SPAN STYLE="background: #99ccff">78. Add definition of flags
(error, etc) in datagram, stream message documents.</SPAN></P>
<P>80. Discuss mechanism for removing entries from routing tables.
E.g. a router could remember the nodeIDs using a particular event,
then purge those entries if no traffic seen, no response to ping for
NN seconds. Not normative, but might be useful? Mostly for consumers;
if producer gone, doesn't produce.</P>
<P><SPAN STYLE="background: #00ff00">83. Fast clock prototype using
events to display. (Shown several times, needs to be in SVN and
documented)</SPAN></P>
<P>84. Add examples to the Datagram and Stream protocol docs with
numerical CAN frames, to make the entire layout clear.</P>
<P>86. “Ident” protocol (item done) Prototype as part of BG
class, needs to have implementation finished up.</P>
<P>89. Finish up the <A HREF="notes/RFIDusage.html">RFID note</A>.
Prototype. David will work on this. 
</P>
<P><SPAN STYLE="background: #00ff00">90. Need to add a lot of useful
detail to Hobbyist intro so people can play with code.<BR>DPH: I
suggest we novice-proof the code to some extent. Eg make the code
insist on the user defining the node-id, etc. Also, define the
high-order bytes of the node-id such that it will be a DIY node.
Obviously this is easy to get around, but by then hopefully they are
not novices :-). </SPAN>
</P>
<P>91. Get CAN shields made so hobbyists can use their existing
Arduino hardware? John Plocher has laid out the Railroad Shield
board. Document use of CAN shields available commercially? LEDuino
production? (Task done).</P>
<P>93. Movies to tell a story!</P>
<UL>
	<LI><P>(done)</P>
	<LI><P>(done)</P>
	<LI><P>Replacing a node, e.g. due to failure, and reprograming WC 
	</P>
	<LI><P>Programming a yard throat 
	</P>
	<LI><P>Breaking a segment in two; show filtering – could use clock
	or DCC for source of events to be filtered. Filtering fast clock
	messages would show event-ranges. 
	</P>
	<LI><P>Fast clock events – David will do: Fast clock source, Fast
	clock display, teaching an alarm event. 
	</P>
</UL>
<P><SPAN STYLE="background: #99ccff">94. Document the use of
new-unique EventIDs during “factory reset” and as a way of
“deleting” an even in a producer or consumer. (See also 103)<BR>We
need to discuss this. I think we should implement a Purge which
replaces any native events in use with new native events – I am not
sure this is what is happening now. (DPH?)</SPAN></P>
<P>97. Servo example: People are starting to like servos, they're
cheap and small, so good support for them is distinguishing. Seems to
be well suited to Arduino-style hardware, P/C and our configuration
code. DPH: Lets try to get a real semaphore working – does anyone
have one?</P>
<P>99. Figure out how to do “Train Forwarding”, an application
described by Reinhard Muller at the NMRA 75 (Milwaukee) meeting.
<BR>DPH: I think this is an application layer problem. It interacts
with auto-topology. Nodes would report loco# on being occupied, and
record it from adjacent blocks' loco-reports. Display is outside our
purview. 
</P>
<P>100. Need tool in C++ prototype for sending arbitrary events
cleanly. Perhaps in PCE? Also Java, needed for JMRI.</P>
<P>101. Refactor BG to use e.g. NM for reset and PCE to send ident.</P>
<P>102. C++ prototype Configuration.cpp should use NM to reset node
number, all but node number, etc</P>
<P><SPAN STYLE="background: #99ccff">103. Configuration needs a
discussion of “Setting/resetting node numbers”; also needed in
Event protocol document. (See also 94)</SPAN><BR>DPH: must redo
discussion about originated-events vs non-originated-events. When
moving a node to a new location, the node should be purged of event#s
so as not to spread them into the wild. I think this needs to be a
user controlled operation. Starting all events#=0, and generating a
new event# (originatingNID.ee) as required for teaching, sounds the
easiest way to handle this. Purging is then just zeroing out the
event#s. This does not waste untaught event#s. Working though
use-cases is useful: taking several nodes to the work-bench for set
up, and reinstalling them to the layout; selling a node; lending a
node; etc. The term “purging' seems to be useful, rather than
“reset”. BobJ: The existing spec requires that a reset of the
board assign new default EventIDs. This is about the best you can do:
If you clear the board, you get new ones. You can't build a
mechanisms that knows whether an EventID has been used or not,
because it's possible for another node to enquire about what EventIDs
the node has and starting using them without out telling the node.
“EventID == 0” doesn't work for default eventIDs, because
teach/learn need isn't the only way that you can learn about the
EventIDs in a node.</P>
<P><SPAN STYLE="background: #00ff00">105. [done] so we can institute
a “daily build” process to check for broken compiles (makefile
done, daily build not; get somebody to do Hudson/Jenkins?) Consider
using the Unity+CMock or (better) the CppUTest+CppUMock test
framework for C/C++ code (Boost no longer favored for C; see
“Test-driven Development for Embedded C”, James Grenning, for
discussion) (see 160) Consider the “GoogleTest” suite of tools
for C/C++.</SPAN></P>
<P>107. Port to mbed. 
</P>
<P>109. A note regarding use of TCP/IP, UDP, etc on Ethernet,
possibly based on <A HREF="http://groups.yahoo.com/group/MRRLCB/message/2702">http://groups.yahoo.com/group/MRRLCB/message/2702</A>,
<A HREF="http://groups.yahoo.com/group/NMRANETWG/message/386">http://groups.yahoo.com/group/NMRANETWG/message/386</A>,
<A HREF="http://groups.yahoo.com/group/NMRANETWG/message/389">http://groups.yahoo.com/group/NMRANETWG/message/389</A>,
and <A HREF="http://groups.yahoo.com/group/NMRANETWG/message/395">http://groups.yahoo.com/group/NMRANETWG/message/395</A>.
(Mike J is working on this)</P>
<P>111. Explore whether raw Ethernet packets is a viable option,
possibly only for a one-segment OpenLCB-node only network for meets,
with other Ethernet connections through another separate Ethernet.
(low priority). (Exploration shows large drop rate) (Ed Richards
suggests investigating multicast enhancements, e.g.
<A HREF="http://stackoverflow.com/questions/31572/broadcast-like-udp-with-the-reliability-of-tcp">http://stackoverflow.com/questions/31572/broadcast-like-udp-with-the-reliability-of-tcp
</A><A HREF="http://en.wikipedia.org/wiki/Pragmatic_General_Multicast">http://en.wikipedia.org/wiki/Pragmatic_General_Multicast</A>
<A HREF="http://code.google.com/p/openpgm/">http://code.google.com/p/openpgm/</A>
<A HREF="http://tools.ietf.org/html/rfc3208">http://tools.ietf.org/html/rfc3208</A>
– separate item?)</P>
<P>112. Consider adding “remote button push” and “remote LED
display” to make it easy to push the buttons on a node from
elsewhere. Combine with e.g. ident protocol to select the node? Makes
a simple remote programmer. See AlanHR email to OpenLCB group August
11, 2010 message 386.</P>
<P>114. Document reply to “Identify Produced (or Consumed) Range”,
including both full range, partial range(s) and individuals; current
document covers just use of identifying routing, no replies. Should
“Identify Produced (or Consumed) Range” over full address space
return replies for all existing Producers (or consumers)?</P>
<P>116. Should “identify” be pulled from the full configuration
protocol and made into something light-weight?</P>
<P>118. We have a discussion in place about developers being able to
assign node ID numbers based on whatever mechanism CBUS uses, which
removes an objection that some CBUS developers had. But this doesn't
cover the case of assigning Event ID numbers entirely, as CBUS has
multiple “event” spaces with overlapping numbering. Briefly,
they've got separate 32-bit and 16-bit event ID address spaces, with
mixed semantics, and on top of that there are modifiers for “off”
and “on”, etc. At the present time, there's little incentive for
OpenLCB to define an interface to this, but there may be in the
future.</P>
<P>119. Do a timing study on how to implement OpenLCB given the PIC
18F2480 requirement of 2msec of frozen CPU on each EEPROM write. Is
there enough buffering to keep CAN alive through that, perhaps with a
backup RAM buffer?</P>
<P>120. C/C++ prototype has some Doxygen comments, but Doxygen isn't
generating them entirely. Also, some comments are still in the older
form, particularly c.f.
prototypes/Arduino/libraries/OpenLCB/OpenLcbCanInterface.h (is that
the current file location, or a left over? Was referred to via the
Arduino web page)</P>
<P>122. Should reservation be pulled from Configuration protocol and
made into a separate mix-in? (Proposal done)</P>
<P>123. Mike Johnson and Paul Bender have expressed interest in a
bridge to XpressNet (Lenz) protocol.</P>
<P>124. Jar file versioning definition in JavaDoc package.html;
JavaDoc to web.</P>
<P>129. Monitor app for Android</P>
<P>135. John Plocher is thinking through the consequences of “NAT”
for UniqueIDs, notably node IDs, but also event IDs. (Consensus seems
to be that this would require some form of “DNS” to be able to
find the new/changes ID numbers for things, with all the undesirable
complexity that involves, but John is a smart guy and it's an
important question)</P>
<P>136. Where can a name for a specific EventID be stashed? This is a
“find a global place from lots of local places, while keeping it
consistent” problem. Maybe stash it on each node as “here's what
I think it means”?</P>
<P>137. More fully develop the “left-both-right switch in the
middle of the CAN bus” proposal for semi-automated configuration of
a large modular layout. Can modern processors with two CAN buses help
here?</P>
<P>139. Fast clock app for iPhone (in SVN, failed App Store approval,
figure out how to do ad-hoc?)</P>
<P>141. Prompted by NMRA 2011 question, discussion of bidirectional
RF for locomotive control. Want to get info back (static and
dynamic). Standard RF technologies, but perhaps more than one? IEEE
802.14.4? Use of built in addressing?</P>
<P>142. Discussion of sizes in non-CAN implementations. (See also
145) E.g. RF that might have 128 byte (or likely smaller) frames. How
to use generic OpenLCB form, but with some limitation on length? 128
bytes allows original MTI+ID sizes (2+6+6) even for datagram in a
single frame. But what to say about other messages, particularly in
the future?</P>
<P>143. Tools in various languages to track alias to full node to new
alias changes when a node needs to keep long term access to an
off-board node IDs.</P>
<P><SPAN STYLE="background: #99ccff">144. The Technical Introduction
doc (TechnicalIntroduction.pdf) needs an update. It's from 2010, and
footnotes are in some cases dead links. </SPAN>
</P>
<P>145. Make sure the CAN frame-level discussion of many-byte global
messages (we don't have any yet, but mechanism documented anyway) is
clear. (See also 142) The entire mechanism for multi-frame messages
like Datagrams, Streams, needs to be clearer described, and
generalized for e.g. 2-frame global messages. Special case of buffer
handling - “must be prepared to receive” as logic, but how handle
multiple coming in to a cheap node?</P>
<P>147. Arduino stream prototype needs to be completed, experiment
with buffer management approaches for small nodes.</P>
<P>148. Would be nice to have favicons on web pages, but OpenOffice
seems to strip the HTML for them.</P>
<P>149. Write a Tech Note for gateway implementors. (See 140, 145,
146) (Skeleton in specs/drafts/GenGatewayTN.odt )</P>
<P>150. Write a C++ bit of code to track alias ↔ node ID mapping &amp;
demonstrate method. (See 143)</P>
<P>152. Bosch is proposing a new standard called CAN-FD with
increased bit-rate over the data portion allowing up to 64 bytes!
<A HREF="http://www.semiconductors.bosch.de/media/pdf/canliteratur/can_fd.pdf">http://www.semiconductors.bosch.de/media/pdf/canliteratur/can_fd.pdf</A></P>
<P>Should the Datagram spec have its max data length reduced to fit
easily within this for ease of migration in the long-term? There are
good reasons to retain the possibility of larger-than-64-byte
datagrams, e.g. so you can have a header of N bytes on the front of
64 data bytes. Perhaps all that's needed is to ensure the datagram
spec can work with larger frames of any length.</P>
<P>154. Write clear specification, justification of Simple Protocol
type, a.k.a. Leaf Node Protocol Subset? (See 151)</P>
<P>156. How is compressed vs non-compressed XML identified? [Item
complete]</P>
<P>157. Should documents move to e.g. MediaWiki? Problem: Offline
consulation. Is there a way to e.g. PDF the entire wiki? An <U>easy</U>
offline browser? See extensions for <A HREF="http://www.mediawiki.org/wiki/Extension:Offline">Offline
extension</A>, <A HREF="http://www.mediawiki.org/wiki/Extension:PDF_Writer">PdfWriter</A>,
<A HREF="http://www.mediawiki.org/wiki/Extension:PdfBook">PdfBook</A>.
</P>
<P>160. Revisit the makefile build process in prototypes/C to clean
it up, separate test &amp; build. Note there are multiple independent
libraries (OpenLCB is one, Olcb* is the other) (see 105)</P>
<P>162. Problem with embedded Arduino XML, see also
http://arduino.cc/en/Guide/troubleshooting#toc4</P>
<P>163. Update to CAN2Ethernet spec for performance</P>
<P><SPAN STYLE="background: transparent">164. </SPAN><SPAN STYLE="background: #99ccff">LSB0
adopted (for bits), documented, but need scan of docs to edit it into
place.</SPAN></P>
<P>166. 
</P>
<P>167.</P>
<P>168.</P>
<P>169.</P>
<P><BR><BR>
</P>
<HR>
<P>Site hosted by <FONT COLOR="#000080">
<A HREF="http://sourceforge.net/projects/openlcb"><FONT COLOR="#000080"><IMG SRC="http://sflogo.sourceforge.net/sflogo.php?group_id=286373&amp;type=13" NAME="graphics1" ALIGN=ABSMIDDLE WIDTH=120 HEIGHT=30 BORDER=2></FONT></A></FONT>
</P>
<P>This is SVN $Revision$ 
</P>
</BODY>
</HTML>