<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>Common Message Types</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.2  (Unix)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGED" CONTENT="20101017;22592600">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="David Harris">
	<!-- $Id$ -->
	<STYLE TYPE="text/css">
	<!--
		H2.ctl { font-family: "Lucida Sans" }
		H3.ctl { font-family: "Lucida Sans" }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>OpenLCB Common Message Types</H1>
<P STYLE="margin-bottom: 0cm">The content listed here is in addition
to the originating NID, MTI and Destination Node ID, if any. The full
format is specified in a <A HREF="CommonMessageFormat.html">separate
note</A>.</P>
<P STYLE="margin-bottom: 0cm">Some messages may be either addressed
to a specific node, or globally addressed to all nodes. These are
indicated by separate MTI values (see below).</P>
<H2 CLASS="western">Base Messages</H2>
<H3 CLASS="western"><A NAME="ic"></A>Initialization Complete</H3>
<P STYLE="margin-bottom: 0cm; font-style: normal">Indicates that the
node is complete, and once the message is delivered, reachable on the
network.</P>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">NID of the sending node</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available.</P>
<H3 CLASS="western"><A NAME="vynid"></A>Verify Node ID</H3>
<P STYLE="margin-bottom: 0cm">Content: None 
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Global (unaddressed) or with specified
destination address.</P>
<H3 CLASS="western"><A NAME="vrnid"></A>Verified Node ID</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">NID of the sending node – this
	is sent in full 48 bit format in all wire protocols, even if an
	alternate form or alias is available elsewhere in the message</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available.</P>
<H3 CLASS="western"><A NAME="psi"></A>Protocol Support Inquiry</H3>
<P STYLE="margin-bottom: 0cm">Content: None</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Destination address required.</P>
<H3 CLASS="western"><A NAME="psr"></A>Protocol Support Reply</H3>
<P STYLE="margin-bottom: 0cm">Content: Bytes containing bits
identifying the available OpenLCB protocols</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Destination address required.</P>
<H3 CLASS="western"><A NAME="oir"></A>Optional Interaction Rejected</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Mandatory original MTI 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Optional error code (TBD) 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Optional data content (TBD)</P>
</UL>
<P STYLE="margin-bottom: 0cm">Destination address required.</P>
<H3 CLASS="western"><A NAME="tde"></A>Terminate Due to Error</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Mandatory most recent MTI 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Mandatory error code (TBD) 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Optional data content (TBD)</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Destination address required.</P>
<H2 CLASS="western">Event Exchange Messages</H2>
<H3 CLASS="western"><A NAME="pcer"></A>Producer/Consumer Event Report</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes) 
	</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available (due to both semantics and CAN limitations).</P>
<H3 CLASS="western"><A NAME="iyc"></A>Identify Consumers</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes) 
	</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available due to CAN limitations.</P>
<H3 CLASS="western"><A NAME="iycr"></A>Identify Consumed Range</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes) with low
	bits as mask</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available due to CAN limitations.</P>
<P STYLE="margin-bottom: 0cm">The least significant bit determines
whether “Low 0 bits are mask” and “Low 1 bits are mask”</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Example: Identify Consumed Range
	with EventID 0x23 23 23 23 23 23 23 2F. The LSB is a 1, so the mask
	is made of 1 bits. The low 1 bits are bits 0-3, since bit 4 is a
	zero. Therefore the mask and value are 0x23 23 23 23 23 23 23 2X</P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Example: A mask of 1 bits can't be
	used for a mask and value of 0x23 23 23 23 23 23 23 7X, as there
	would be 7 low order 1 bits in that case, and they'd be interpreted
	as a 7-bit mask. Instead, use 0 bits for the mask: Identify Consumed
	Range with EventID 0x23 23 23 23 23 23 23 70 gives a mask and value
	of 0x23 23 23 23 23 23 23 7X.</P>
</UL>
<H3 CLASS="western"><A NAME="ci"></A>Consumer Identified</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes) 
	</P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Flags: 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">&quot;valid&quot; if set, the
	current state of the node corresponds to this P/C Event ID having
	been received. 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">&quot;uncertain&quot; if set, the
	&quot;valid&quot; bit value is not known to be correct 
	</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available due to CAN limitations.</P>
<H3 CLASS="western"><A NAME="iyp"></A>Identify Producers</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes) 
	</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available due to CAN limitations.</P>
<H3 CLASS="western"><A NAME="iypr"></A>Identify Produced Range</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes) with low
	bits as mask</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available due to CAN limitations.</P>
<P STYLE="margin-bottom: 0cm">The least significant bit determines
whether “Low 0 bits are mask” and “Low 1 bits are mask”</P>
<H3 CLASS="western"><A NAME="pi"></A>Producer Identified</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes) 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">Flags: 
	</P>
	<LI><P STYLE="margin-bottom: 0cm">&quot;valid&quot; if set, the
	current state of the node corresponds to this P/C Event ID being
	eligible to be sent.</P>
	<LI><P STYLE="margin-bottom: 0cm">&quot;uncertain&quot; if set, the
	&quot;valid&quot; bit value is not known to be correct 
	</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available due to CAN limitations.</P>
<H3 CLASS="western"><A NAME="ie"></A>Identify Events</H3>
<P STYLE="margin-bottom: 0cm">Content: None</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Destination address required.</P>
<H3 CLASS="western"><A NAME="le"></A>Learn Event</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">P/C Event ID (8 bytes)</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only Global (unaddressed) form
available due to CAN limitations.</P>
<H2 CLASS="western">Datagram Messages</H2>
<P>The use of these messages by the datagram protocol is defined in a
<A HREF="DatagramProtocol.html">separate document</A>. 
</P>
<H3 CLASS="western"><A NAME="dgc"></A>Datagram Content</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Data content</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<H3 CLASS="western"><A NAME="dgrok"></A>Datagram Received OK</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P></P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<H3 CLASS="western"><A NAME="dgrj"></A>Datagram Rejected</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Flags</P>
	<LI><P STYLE="margin-bottom: 0cm">Error condition</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<H2 CLASS="western">Stream Messages</H2>
<P>The use of these messages by the stream protocol is defined in a
<A HREF="StreamProtocol.html">separate document</A>. 
</P>
<H3 CLASS="western"><A NAME="stirq"></A>Stream Initiate Request</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Max Buffer Size – 2 bytes</P>
	<LI><P STYLE="margin-bottom: 0cm">Flags</P>
	<LI><P STYLE="margin-bottom: 0cm">Tagged – indicates that the
	start of the stream is a 6-byte standard Stream type ID</P>
	<LI><P STYLE="margin-bottom: 0cm">Source Stream ID – 1 byte</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<H3 CLASS="western"><A NAME="stiry"></A>Stream Initiate Reply</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Max Buffer Size – 2 bytes</P>
	<LI><P STYLE="margin-bottom: 0cm">Flags:</P>
	<LI><P STYLE="margin-bottom: 0cm">Accept/Reject – indicates
	whether the request was accepted or rejected</P>
	<LI><P STYLE="margin-bottom: 0cm">Tagged – indicates that the
	start of the stream is a 6-byte standard Stream type ID</P>
	<LI><P STYLE="margin-bottom: 0cm">Source Stream ID – 1 byte</P>
	<LI><P STYLE="margin-bottom: 0cm">Destination Stream ID – 1 byte</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<H3 CLASS="western"><A NAME="stds"></A>Stream Data Send</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Source Stream ID – 1 byte</P>
	<LI><P STYLE="margin-bottom: 0cm">Destination Stream ID – 1 byte</P>
	<LI><P STYLE="margin-bottom: 0cm">Data</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<H3 CLASS="western"><A NAME="stdp"></A>Stream Data Proceed</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Source Stream ID – 1 byte</P>
	<LI><P STYLE="margin-bottom: 0cm">Destination Stream ID – 1 byte</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<H3 CLASS="western"><A NAME="stdc"></A>Stream Data Complete</H3>
<P STYLE="margin-bottom: 0cm">Content:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Source Stream ID – 1 byte</P>
	<LI><P STYLE="margin-bottom: 0cm">Destination Stream ID – 1 byte</P>
	<LI><P STYLE="margin-bottom: 0cm">Full length (4 bytes, optional;
	zero means unknown)</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Only addressed form available.</P>
<HR>
<P>Site hosted by <FONT COLOR="#000080">
<A HREF="http://sourceforge.net/projects/openlcb"><FONT COLOR="#000080"><IMG SRC="http://sflogo.sourceforge.net/sflogo.php?group_id=286373&amp;type=13" NAME="graphics1" ALIGN=ABSMIDDLE WIDTH=120 HEIGHT=30 BORDER=2></FONT></A></FONT>
</P>
<P>This is SVN $Revision$ 
</P>
</BODY>
</HTML>